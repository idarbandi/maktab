<!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <title>&#x633;&#x644;&#x646;&#x6cc;&#x648;&#x645;&colon; &#x627;&#x632; &#x627;&#x62a;&#x648;&#x645;&#x627;&#x633;&#x6cc;&#x648;&#x646; &#x67e;&#x6cc;&#x634;&#x631;&#x641;&#x62a;&#x647; &#x62a;&#x627; &#x627;&#x633;&#x6a9;&#x631;&#x6cc;&#x646;&zwnj;&#x634;&#x627;&#x62a;&zwnj;&#x647;&#x627;&#x6cc; &#x647;&#x648;&#x634;&#x645;&#x646;&#x62f; &#x648; &#x627;&#x633;&#x6a9;&#x631;&#x627;&#x67e;&#x6cc;&#x646;&#x6af; &#x62d;&#x631;&#x641;&#x647;&zwnj;&#x627;&#x6cc; &#x1f680;</title>
            <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only],
.vscode-high-contrast:not(.vscode-high-contrast-light) img[src$=\#gh-light-mode-only],
.vscode-high-contrast-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

</style>
            
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item {
    list-style-type: none;
}

.task-list-item-checkbox {
    margin-left: -20px;
    vertical-align: middle;
    pointer-events: none;
}
</style>
<style>
:root {
  --color-note: #0969da;
  --color-tip: #1a7f37;
  --color-warning: #9a6700;
  --color-severe: #bc4c00;
  --color-caution: #d1242f;
  --color-important: #8250df;
}

</style>
<style>
@media (prefers-color-scheme: dark) {
  :root {
    --color-note: #2f81f7;
    --color-tip: #3fb950;
    --color-warning: #d29922;
    --color-severe: #db6d28;
    --color-caution: #f85149;
    --color-important: #a371f7;
  }
}

</style>
<style>
.markdown-alert {
  padding: 0.5rem 1rem;
  margin-bottom: 16px;
  color: inherit;
  border-left: .25em solid #888;
}

.markdown-alert>:first-child {
  margin-top: 0
}

.markdown-alert>:last-child {
  margin-bottom: 0
}

.markdown-alert .markdown-alert-title {
  display: flex;
  font-weight: 500;
  align-items: center;
  line-height: 1
}

.markdown-alert .markdown-alert-title .octicon {
  margin-right: 0.5rem;
  display: inline-block;
  overflow: visible !important;
  vertical-align: text-bottom;
  fill: currentColor;
}

.markdown-alert.markdown-alert-note {
  border-left-color: var(--color-note);
}

.markdown-alert.markdown-alert-note .markdown-alert-title {
  color: var(--color-note);
}

.markdown-alert.markdown-alert-important {
  border-left-color: var(--color-important);
}

.markdown-alert.markdown-alert-important .markdown-alert-title {
  color: var(--color-important);
}

.markdown-alert.markdown-alert-warning {
  border-left-color: var(--color-warning);
}

.markdown-alert.markdown-alert-warning .markdown-alert-title {
  color: var(--color-warning);
}

.markdown-alert.markdown-alert-tip {
  border-left-color: var(--color-tip);
}

.markdown-alert.markdown-alert-tip .markdown-alert-title {
  color: var(--color-tip);
}

.markdown-alert.markdown-alert-caution {
  border-left-color: var(--color-caution);
}

.markdown-alert.markdown-alert-caution .markdown-alert-title {
  color: var(--color-caution);
}

</style>
        
        </head>
        <body class="vscode-body vscode-light">
            <div dir="rtl">
<h3 id="سلنیوم-از-اتوماسیون-پیشرفته-تا-اسکرینشاتهای-هوشمند-و-اسکراپینگ-حرفهای-">سلنیوم: از اتوماسیون پیشرفته تا اسکرین‌شات‌های هوشمند و اسکراپینگ حرفه‌ای 🚀</h3>
<p>اگر قبلاً با سلنیوم کار کرده‌اید، این مقاله دنیای جدیدی از قابلیت‌های پنهان آن را به شما نشان می‌دهد! از تکنیک‌های حرفه‌ای اسکرین‌شات تا اسکراپ داده‌های پیچیده، همه را با جزئیات عملی یاد بگیرید.</p>
<hr>
<h3 id="-سلنیوم-نه-فقط-برای-تست-بلکه-برای-مهندسی-داده">🔥 سلنیوم: نه فقط برای تست، بلکه برای <strong>مهندسی داده</strong>!</h3>
<p>بله! سلنیوم فقط برای تست خودکار نیست. تصور کنید:</p>
<ul>
<li>ساخت <strong>دیتابیس واقعی</strong> از قیمت مسکن با اسکراپ ۲۰ سایت املاک</li>
<li>خودکارسازی <strong>پر کردن فرم‌های اداری</strong> تکراری</li>
<li>مانیتورینگ لحظه‌ای <strong>تغییرات محتوای سایت‌های رقیب</strong></li>
</ul>
<hr>
<h3 id="-هنر-اسکرینشات-از-پایه-تا-پیشرفته-با-۵-لایه-حرفهای">🎯 هنر اسکرین‌شات: از پایه تا پیشرفته با ۵ لایه حرفه‌ای</h3>
<h4 id="۱-اسکرینشات-تمامصفحه-full-page-screenshot-">۱. <strong>اسکرین‌شات تمام‌صفحه (Full Page Screenshot) 🔍</strong></h4>
<p>با این تکنیک حتی قسمت‌های خارج از دید مرورگر هم ذخیره می‌شوند:</p>
<pre><code class="language-python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver

<span class="hljs-keyword">def</span> <span class="hljs-title function_">full_page_screenshot</span>(<span class="hljs-params">driver, file_name</span>):
    total_height = driver.execute_script(<span class="hljs-string">&quot;return document.body.parentNode.scrollHeight&quot;</span>)
    driver.set_window_size(<span class="hljs-number">1920</span>, total_height)
    driver.save_screenshot(file_name)

driver = webdriver.Chrome()
driver.get(<span class="hljs-string">&quot;https://example.com&quot;</span>)
full_page_screenshot(driver, <span class="hljs-string">&quot;full_page.png&quot;</span>)
</code></pre>
<h4 id="۲-اسکرینشات-هوشمند-با-تشخیص-خودکار-خطا-">۲. <strong>اسکرین‌شات هوشمند با تشخیص خودکار خطا 🚨</strong></h4>
<p>با ترکیب <code>try-except</code> و اسکرین‌شات:</p>
<pre><code class="language-python"><span class="hljs-keyword">from</span> selenium.common.exceptions <span class="hljs-keyword">import</span> NoSuchElementException

<span class="hljs-keyword">try</span>:
    driver.find_element(By.ID, <span class="hljs-string">&quot;element_id&quot;</span>)
<span class="hljs-keyword">except</span> NoSuchElementException:
    driver.save_screenshot(<span class="hljs-string">&quot;error_&quot;</span>+ datetime.now().strftime(<span class="hljs-string">&quot;%Y%m%d_%H%M%S&quot;</span>) + <span class="hljs-string">&quot;.png&quot;</span>)
    <span class="hljs-keyword">raise</span>
</code></pre>
<h4 id="۳-اسکرینشت-از-المانهای-پویا-با-هایلایت-">۳. <strong>اسکرین‌شت از المان‌های پویا با هایلایت 🔦</strong></h4>
<p>با این کد، المان مورد نظر حاشیه قرمز می‌گیرد:</p>
<pre><code class="language-python">element = driver.find_element(By.ID, <span class="hljs-string">&quot;target_element&quot;</span>)
driver.execute_script(<span class="hljs-string">&quot;arguments[0].style.border = &#x27;3px solid red&#x27;&quot;</span>, element)
element.screenshot(<span class="hljs-string">&quot;element_shot.png&quot;</span>)
</code></pre>
<h4 id="۴-اسکرینشات-متحرک-gif-">۴. <strong>اسکرین‌شات متحرک (GIF) 🎥</strong></h4>
<p>با استفاده از کتابخانه <code>imageio</code>:</p>
<pre><code class="language-python"><span class="hljs-keyword">import</span> imageio
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image

screenshots = []
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
    driver.save_screenshot(<span class="hljs-string">f&quot;frame_<span class="hljs-subst">{_}</span>.png&quot;</span>)
    screenshots.append(Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;frame_<span class="hljs-subst">{_}</span>.png&quot;</span>))
    
imageio.mimsave(<span class="hljs-string">&#x27;animation.gif&#x27;</span>, screenshots, duration=<span class="hljs-number">0.5</span>)
</code></pre>
<h4 id="۵-اسکرینشات-سهبعدی-با-استفاده-از-css-transform-️">۵. <strong>اسکرین‌شات سه‌بعدی با استفاده از CSS Transform 🕶️</strong></h4>
<p>شبیه‌سازی نمای سه‌بعدی:</p>
<pre><code class="language-python">driver.execute_script(<span class="hljs-string">&quot;document.body.style.transform = &#x27;rotateY(20deg)&#x27;;&quot;</span>)
driver.save_screenshot(<span class="hljs-string">&quot;3d_view.png&quot;</span>)
</code></pre>
<hr>
<h3 id="️-اسکراپینگ-پیشرفته-عبور-از-تلههای-ضد-بات">🕸️ اسکراپینگ پیشرفته: عبور از تله‌های ضد بات</h3>
<h4 id="تکنیکهای-حیاتی">تکنیک‌های حیاتی:</h4>
<ul>
<li><strong>شبیه‌سازی رفتار انسانی:</strong><br>
استفاده از <code>ActionChains</code> برای حرکت ماوس تصادفی</li>
</ul>
<pre><code class="language-python"><span class="hljs-keyword">from</span> selenium.webdriver.common.action_chains <span class="hljs-keyword">import</span> ActionChains
<span class="hljs-keyword">import</span> random

actions = ActionChains(driver)
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):
    actions.move_by_offset(random.randint(-<span class="hljs-number">50</span>,<span class="hljs-number">50</span>), random.randint(-<span class="hljs-number">50</span>,<span class="hljs-number">50</span>))
actions.perform()
</code></pre>
<ul>
<li><strong>دور زدن تشخیص هدلس:</strong><br>
افزودن ویژگی‌های مرورگر واقعی:</li>
</ul>
<pre><code class="language-python">options = webdriver.ChromeOptions()
options.add_argument(<span class="hljs-string">&quot;--disable-blink-features=AutomationControlled&quot;</span>)
options.add_argument(<span class="hljs-string">&quot;user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...&quot;</span>)
</code></pre>
<ul>
<li><strong>اسکراپ داده‌های جدولی پیشرفته:</strong><br>
استخراج داده‌های پیچیده از جداول:</li>
</ul>
<pre><code class="language-python">table = driver.find_element(By.TAG_NAME, <span class="hljs-string">&quot;table&quot;</span>)
rows = table.find_elements(By.TAG_NAME, <span class="hljs-string">&quot;tr&quot;</span>)

data = []
<span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> rows:
    cols = row.find_elements(By.TAG_NAME, <span class="hljs-string">&quot;td&quot;</span>)
    data.append([col.text <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> cols <span class="hljs-keyword">if</span> col.text.strip() != <span class="hljs-string">&#x27;&#x27;</span>])
</code></pre>
<ul>
<li><strong>اسکراپ صفحات با اسکرول نامحدود:</strong><br>
اتوماتیک کردن اسکرول تا انتهای صفحه:</li>
</ul>
<pre><code class="language-python">last_height = driver.execute_script(<span class="hljs-string">&quot;return document.body.scrollHeight&quot;</span>)
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    driver.execute_script(<span class="hljs-string">&quot;window.scrollTo(0, document.body.scrollHeight);&quot;</span>)
    time.sleep(<span class="hljs-number">2</span>)
    new_height = driver.execute_script(<span class="hljs-string">&quot;return document.body.scrollHeight&quot;</span>)
    <span class="hljs-keyword">if</span> new_height == last_height:
        <span class="hljs-keyword">break</span>
    last_height = new_height
</code></pre>
<hr>
<h3 id="-یکپارچهسازی-با-سیستمهای-گزارشگیری">📊 یکپارچه‌سازی با سیستم‌های گزارش‌گیری</h3>
<h4 id="مثال-با-allure-report">مثال با <strong>Allure Report</strong>:</h4>
<pre><code class="language-python"><span class="hljs-keyword">import</span> allure

<span class="hljs-meta">@allure.feature(<span class="hljs-params"><span class="hljs-string">&#x27;تست لاگین&#x27;</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_login</span>():
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># کد تست</span>
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        allure.attach(driver.get_screenshot_as_png(), name=<span class="hljs-string">&quot;خطای_لاگین&quot;</span>, 
                      attachment_type=allure.attachment_type.PNG)
        <span class="hljs-keyword">raise</span> e
</code></pre>
<h4 id="تولید-گزارش-html-سفارشی">تولید گزارش HTML سفارشی:</h4>
<pre><code class="language-python"><span class="hljs-keyword">from</span> jinja2 <span class="hljs-keyword">import</span> Template

report_template = Template(<span class="hljs-string">&#x27;&#x27;&#x27;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;گزارش تست&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {% for img in screenshots %}
    &lt;h2&gt;{{ img.title }}&lt;/h2&gt;
    &lt;img src=&quot;{{ img.path }}&quot; width=&quot;80%&quot;&gt;
    {% endfor %}
&lt;/body&gt;
&lt;/html&gt;
&#x27;&#x27;&#x27;</span>)

<span class="hljs-comment"># تولید گزارش</span>
report_html = report_template.render(screenshots=[
    {<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;خطای لاگین&#x27;</span>, <span class="hljs-string">&#x27;path&#x27;</span>: <span class="hljs-string">&#x27;error_login.png&#x27;</span>},
    {<span class="hljs-string">&#x27;title&#x27;</span>: <span class="hljs-string">&#x27;صفحه اصلی&#x27;</span>, <span class="hljs-string">&#x27;path&#x27;</span>: <span class="hljs-string">&#x27;homepage.png&#x27;</span>}
])
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;report.html&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:
    f.write(report_html)
</code></pre>
<hr>
<h3 id="-ترفندهای-طلایی-برای-حرفهایها">💡 ترفندهای طلایی برای حرفه‌ای‌ها</h3>
<ol>
<li><strong>شبیه‌سازی تایپ واقعی:</strong><br>
با تاخیر تصادفی بین کی‌استروک‌ها:</li>
</ol>
<pre><code class="language-python"><span class="hljs-keyword">from</span> selenium.webdriver.common.keys <span class="hljs-keyword">import</span> Keys
<span class="hljs-keyword">import</span> random

<span class="hljs-keyword">def</span> <span class="hljs-title function_">human_type</span>(<span class="hljs-params">element, text</span>):
    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> text:
        element.send_keys(char)
        time.sleep(random.uniform(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.3</span>))
    element.send_keys(Keys.RETURN)
</code></pre>
<ol start="2">
<li>
<p><strong>عبور از CAPTCHA:</strong><br>
(فقط برای اهداف آموزشی!)</p>
<ul>
<li>استفاده از سرویس‌های حل CAPTCHA مانند 2Captcha</li>
<li>تشخیص متن با کتابخانه <code>pytesseract</code></li>
</ul>
</li>
<li>
<p><strong>مدیریت کوکی‌ها:</strong><br>
ذخیره و بازیابی سشن:</p>
</li>
</ol>
<pre><code class="language-python"><span class="hljs-comment"># ذخیره کوکی‌ها</span>
<span class="hljs-keyword">import</span> pickle
pickle.dump(driver.get_cookies(), <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;cookies.pkl&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>))

<span class="hljs-comment"># بارگذاری کوکی‌ها</span>
cookies = pickle.load(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;cookies.pkl&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>))
<span class="hljs-keyword">for</span> cookie <span class="hljs-keyword">in</span> cookies:
    driver.add_cookie(cookie)
</code></pre>
<hr>
<h3 id="-معماری-پیشرفته-برای-پروژههای-بزرگ">📈 معماری پیشرفته برای پروژه‌های بزرگ</h3>
<pre><code class="language-mermaid">graph TD
    A[اسکرپر اصلی] --&gt; B[مدیریت پروکسی]
    A --&gt; C[شبیه‌سازی رفتار]
    A --&gt; D[استخراج داده]
    B --&gt; E[چرخش IP خودکار]
    C --&gt; F[الگوی حرکت ماوس]
    C --&gt; G[تایپ انسانی]
    D --&gt; H[پایگاه داده]
    H --&gt; I[MySQL]
    H --&gt; J[MongoDB]
    H --&gt; K[CSV/Excel]
</code></pre>
<hr>
<h3 id="جمعبندی-نهایی-سلنیوم-به-عنوان-سوئیس-چاقوی-دیجیتال">جمع‌بندی نهایی: سلنیوم به عنوان <strong>سوئیس چاقوی دیجیتال</strong></h3>
<p>امروز یاد گرفتیم:</p>
<ul>
<li>گرفتن اسکرین‌شات‌های <strong>هوشمند با قابلیت ردیابی خطا</strong></li>
<li>ساخت <strong>سیستم گزارش‌گیری خودکار</strong> حرفه‌ای</li>
<li>تکنیک‌های <strong>اسکراپ داده‌های مقاوم</strong> در برابر تشخیص</li>
<li><strong>بهینه‌سازی عملکرد</strong> در مقیاس بزرگ</li>
</ul>
<p>به یاد داشته باشید: <strong>اتوماسیون هنر است</strong>! هر پروژه نیاز به ترکیبی از خلاقیت و تکنیک‌های فنی دارد.</p>
<p>اگر سوالی دارید یا نیاز به راهنمایی در مورد سناریوهای خاص دارید، در کامنت‌ها مطرح کنید. در دنیای اتوماسیون موفق باشید! 🚀</p>
<hr>
<h3 id="ارتباط-با-من">ارتباط با من</h3>
<ul>
<li><strong>ایمیل:</strong> <a href="mailto:darbandidr99@gmail.com">darbandidr99@gmail.com</a></li>
<li><strong>گیت‌هاب:</strong> <a href="https://github.com/idarbandi/">github.com/idarbandi</a></li>
<li><strong>مقاله تجربه شخصی من در یادگیری اتوماسیون مرورگر با پایتون:</strong> <a href="https://virgool.io/@darbandidr99/%D8%AA%D8%AC%D8%B1%D8%A8%D9%87-%D8%B4%D8%AE%D8%B5%DB%8C-%D9%85%D9%86-%D8%AF%D8%B1-%DB%8C%D8%A7%D8%AF%DA%AF%DB%8C%D8%B1%DB%8C-%D8%A7%D8%AA%D9%88%D9%85%D8%A7%D8%B3%DB%8C%D9%88%D9%86-%D9%85%D8%B1%D9%88%D8%B1%DA%AF%D8%B1-%D8%A8%D8%A7-%D9%BE%D8%A7%DB%8C%D8%AA%D9%88%D9%86-zkmm3qpdmbho">مطالعه در ویرگول (فارسی)</a></li>
</ul>
<p><strong>نوشته شده توسط: امیر حسین دربندی</strong><br>
<strong>پاینده باشید!</strong></p>
</div>
            
            
        </body>
        </html>